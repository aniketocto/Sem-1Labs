1.Learn basics set working directory, vectors and vector operations




b=seq (from=1,to =13, by=2)
b
my_num=c(5,7,2,4,9,10)
my_num
c="SubaNandita"
c
class(c)
length(c)

code:
fruits =c("cherry","pineapple","strawberry")
fruits

objects()
myString<-"Hello World"
print(myString)
myString



4.code:
#setwd()-sets current working directory
setwd("C:\Users\mca2556\Documents")
#getwd()-gets currunt working directory
getwd()



5.code:
#dir()-list all files
dir()



Creating and inspecting the vector
x <-c(61,4,11,23,3,5)
cat('\n','Vector using c function','\n', x) length(x)
typeof(x)
class(x)

Creating and inspecting the vector y using seq

y<-seq(1,10,length.out=5)
cat('\n','Vector using seq function','\n', y) length(y)
typeof(y)

Creating and inspecting the vector r using a range
r<-2:7

cat('\n','vector using range function','\n', r)

Reassigning y to a character vector
length(r)
typeof(r)
class(r)
y<-c('Apple','Cherry','banana')
length(y)
y
a<-5
b<-7
a>b
b<5
a==3
a!=b

x<-c(3,4,7)
y<-c(4,4,7)
x<y
x+y
x-y
x[3]
z<-y[2] #passing 2nd element value to Z z
x[1:3] #from 1 to 3 range
y[-2] #Excludes 2nd elem
x[c(1,3)]


create two vectors with 10 elements in each vector.


NOTE : vector should not contain values from 1 to 10.
values must be 10 random values.
Do addition and subtraction to that vectors and all other operations on these
two vectors



x <-c(88,43,32,21,1,5 ,12, 2 ,66,34)

y <-c(97,69,91,23,25 ,42,45 ,16,1,3)

x+y
x-y
x[3]
t<-x[2]
t
x>y
y==x
----------------------------------------------------------------------------------------------

2.List, Matrix, Factors and Dataframes

1] List
Code:

mylist<-list(name="David",age=20,city="Mumbai")
print(mylist)

empid=c(1,2,3,4)
empName=c("XYZ","ABC","PQR","MNO")
numberOfEmp=4

empList=list("ID"=empid,"Name"=empName,"TotalEmp"=numberOfEmp)
print(empList$Name)
print(empList$Name[2])
#Accessing the numberOfEmp column and will display date, i.e.4
print(empList[3][1])

empid=c(1,2,3,4)
empName=c("Nandita","Jeet","Sairaj","Aryan")
numberOfEmp=4
empList1=list("ID"=empid,"Name"=empName,"TotalEmp"=numberOfEmp)

empList1$'TotalEmp'=5

empList1[[1]][5]=5
empList1[[2]][5]="DEF"

print(empList1)

empList1[[2]][1]="SUBA"
empList1$Name



2) Integer concatenation
Code:

#integer Concatenation

list1=list(1,3,5,7,9)
list2=list(2,4,6,8,10)
print(list1)
print(list2)
combined<-c(list1,list2)
print(combined)

#String Concatenation
list3=list("ABC")
list4=list("DEF")
print(list3)
print(list4)
combined1<-c(list3,list4)
print(combined1)



3) Matrix
Code:
m<-matrix(c(11,12,13,55,60,65,66,72,78),nrow=3,ncol=3)
m

dim(m)

m<-matrix(c(11,12,13,55,60,65,66,72,78),nrow=3,ncol=3,byrow = TRUE)
m

#By default, elements in matrix are filled by column.
#"byrow" attribute of matrix can be used.
matrix(c(11,12,13,55,60,65,66,72,78),nrow=3,ncol=3,byrow = TRUE)
m

#cbind-ing and rbind-ing:

#By using sbind() and rbind()functions
x<-c(1,2,3)
y<-c(11,12,13)
z<-cbind(x,y)
z

z<-rbind(x,y)
z

4) Operations
Code:
#multiplication by a scalar

p<-3*m
p
n<- matrix(c(4,5,6,14,15,16,24,25,26),nrow=3,ncol=3)

#Addition of two matrics
q<-m+n
q
o<-matrix(c(4,5,6,14,15,16,24,25,26),nrow=3,ncol=3)
o

#Matrix multiplication by using %*%
r<-m%*%o
r

#Transpose of Matrix

mdash<-t(m)
mdash
s<-matrix(c(4,5,6,14,15,16,24,25,26),nrow=3,ncol=3,byrow = TRUE)

#Determinanat of s
s_det<-det(s)
s_det


5) Factors
Code:
#Creating a vector
x<-c("female","male","male","female")
print(x)

#Converting the vector x into a factor
#named gender
gender<-factor(x)
print(gender)

#Creating a factor with levels defined by programmer
gender<-factor(c("female","male","male","female"),
levels = c("female","transgender","male"));

gender
#checking for a Factor in R
gender<-factor(c("female","male","male","female"));
print(is.factor(gender))
#Accessing element of a factor in R
gender<-factor(c("female","male","male","female"));

gender[3]
#more than one element can be accessed at a time.
gender<-factor(c("female","male","male","female"));
gender[c(2,4)]

#Subtract one element at a time.
gender<-factor(c("female","male","male","female"));
gender[-3]

#Modification of a Factor in R
gender<-factor(c("female","male","male","female"));
gender[2]<-"female"
gender


6) Dataframes
Code:
#R Program to create a dataframe
#creating a data frame

friend.data<-data.frame(
friend_id=c(1:5),
friend_name=c("Sachin","SouraV","David","Sehwag","Dhoni"),
stringsAsFactors = FALSE
)
#print the data frame
print(friend.data)

#R program to get the structure of the data frame
#using str()
print(str(friend.data))

#R program to get summary of the data frame
#using summary()
print(summary(friend.data))

#R program to extract data from the data frame

#Extracting friend_name column
result<-data.frame(friend.data$friend_name)
print(result)

#R program to expand the data frame
#Expanding data frame
friend.data$location<-c("Kolkata","Delhi",
"Bangalore","Hyderabad",
"Chennai")
resultant<-friend.data
#Print the modified data frame
print(resultant)

#Access items using []
friend.data[1]

#Access items using [[]]
friend.data[["friend_name"]]

#Access items using $
friend.data$friend_id



7) Adding rows and cols in data frame
Code:
#Add rows and columns in R Data Frame
#Creating a dataframe representing products in a store
Products<-data.frame(
Product_ID=c(101,102,103),
Product_Name=c("T-shirt","Jeans","Shoes"),
Price=c(299,399,499),
Stock=c(50,30,25)
)
#print the existing data frame
cat("Existing dataframe(Products):\n")
print(Products)

#Adding a new row for a new product
New_Product<-c(104,"Sunglasses",299,40)
Products<-rbind(Products,New_Product)

#print the updated data frame after adding the new product
cat("\n Updated data frame after adding the new product;\n")
print(Products)

#Adding a new column for "Discount" to the data frame
Discount<-c(5,10,8,15) #New Column values for discount
Products<-cbind(Products,Discount)

#Rename the added column
colnames(Products)[ncol(Products)]<-"Discount"
#Renaming the last column
#Print the updated data frame after adding the new column
cat("\n Update data frame after adding a new column 'Discount:\n")
print(Products)


8) Combing Dataframes in R
Code:
#Combining Data Frames in R
#Creating two sample data frames

df1<-data.frame(
Name = c("Nandita","Jeet"),
Age = c(21,23),
Score = c(80,75)
)

df2<-data.frame(
Name = c("Sairaj","Aniket"),
Age = c(28,21),
Score = c(75,85)
)

#Print the existing data frames
cat("Dataframe 1:\n")
print(df1)

cat("Dataframe 2:\n")
print(df2)

#Combining the data frames using rbind()
combined_df<-rbind(df1,df2)

#Print the combined data frame
cat("\n Combined Dataframe:\n")
print(combined_df)

#Combining the data frames using cbind()
combined_df<-cbind(df1,df2)

#Print the combined data frame
cat("\n Combined Dataframe:\n")
print(combined_df)

------------------------------------------

import data from excel
using libraries

1) Code:
install.packages("XLConnect")
library(XLConnect)
install.packages("readxl")
library(readxl)
install.packages("writexl")
library(writexl)
dataT<-read.table("data.csv",sep=",",header=T)
dataT
getwd()
class(dataT)
head(dataT)
dim(dataT)
tail(dataT,2)
dim(dataT)
z<-data.frame(a=5,b=10,c=pi)
write.csv(z,file="datanew.csv",)
dataR<-read.table("datanew.csv",)
dataR

View(dataR)
View(dataT)

---------------------------------------------

Data preprocessing

Missing values
Data reduction

Code:
install.packages("dplyr")
library(dplyr)
my_data<-mtcars
head(mtcars,5)

my_data<-my_data[1:6.1:5]
require(dplyr)
my_data<-rename(my_data,horse_power=hp)
my_data$new_hp<-my_data$horse_power*0.5
colnames(my_data)

my_data

data<-read.table(file="missing_col.csv",sep=",")
data<-read.table(file="missing_col.csv",sep=",",col.names =
c("Sno","NAME","SALARY","date_of_joining","Department"))

data

V<-c(1,2,NA,3)
V[complete.cases(V)]
naVals<-is.na(V)
V[!naVals]

install.packages("Hmisc")
library(Hmisc)
x=c(1,2,3,NA,4,4,NA)
v<-impute(x,fun=mean)
v

v<-impute(x,fun=median)
v
c1<-c("low","medium","high","low")
c1<-factor(c1,levels=c("low","medium","high"))
c1
data1<-read.csv("missing_col.csv",sep=",",col.names=c("Srno","Name","salary","DO
J","Department"))
View(data1)
x<-c(1,2,3,NA,4,NA,5)
x
#indicates which elements are missing
xn<-is.na(x)
x[!xn]
NA+4
#this will keep NA rows in data while removes them during calculation
median(x,na.rm=T)
#return a logical vector indicating which cases are complete
#i.e.,have no missing value

complete.cases(x)
is.na(data1)
datacompletecases<-data1[complete.cases(data1),]
datacompletecases

#detect if there are any Nas: any(is.na(data))
#Identify positions of NAs:which(is.na(data$v1))
any(is.na(x))
which(is.na(data1$srno))
na.omit(x)

-----------

Data Mining Algorithms

Objective Linear Regression



Code:
x<-c(3,8,9,13,3,6,11,21,1,16)
#response variable

y<-c(30,57,64,72,36,43,59,90,20,83)
plot(x,y)

plot(x,y,col='red' , main="scatter plot")

model=lm(y~x)
model
attributes(model)

coef(model)
residuals(model)
summary(model)
abline(model)

#Predicting value manually y=a+bx
x10<-model$coefficients[[1]]+model$coefficients[[2]]*10
x10

#using predict()
a<-data.frame(x=10)
a
pred <- predict(model,a)pred

plot(model)


------------------------------------------------

Naive Bayesian Algorithm, KNN, ID3, C4.5

Naive Bayesian Algorithm

Code:
install.packages("e1071")
install.packages("caTools")
install.packages("caret")

library(e1071)
library(caTools)
library(caret)
View(iris)

ir<-iris
train=ir[1:100,]
train

test=ir[101:150,]
testmodel=naiveBayes(Species~.,data=train)
model
test$Species

model
test$Species
train$Species

train$Species
pred=predict(model,test)
table(pred)
table(test$Species)
table(train$Species)

#shuffle iris file
ir1=ir[sample(nrow(ir)),]
View(ir1)
train=ir1[1:100,]
test=ir1[101:50,]
model=model=naiveBayes(Species~.,data=train)
pred=predict(model, test)
table(pred)

table(train$Species)
table(test$Species)


KNN

Code:
install.packages("class")
library(class)

table(iris$Species)
head(iris)
ir=iris
train=ir[1.100,]
ir1=ir[sample(nrow(ir)),]
head(ir1)
normalize<-function(x){
return((x-min(x)/(max(x)-min(x))))
}
iris_n<-as.data.frame(lapply(ir1[,c(1,2,3,4)], normalize))
str(iris_n)
iris_train<-iris_n[1:129,]
iris_test<-iris_n[130:150,]
iris_train_target<-iris[1:129,5]
iris_test_target<-iris[130:150,5]
iris_train_target
dim(iris_train)
dim(iris_test)
model<-knn(iris_train,iris_test,cl=iris_train_target,k=13)
model
table(iris_test_target,model)


ID3

Code:
#install and load required packages
install.packages("rpart")
install.packages("rpart.plot")
library(rpart)
library(rpart.plot)

#create a sample dataset
data <- data.frame(
Outlook = c("Sunny","Sunny","Overcast","Rain","Rain","Rain","Overcast",
"Sunny","Sunny","Rain","Sunny","Overcast","Overcast","Rain"),
Temperature = c("Hot","Hot","Hot","Mild","Cool","Cool","Cool",
"Mild","Cool","Mild","Mild","Mild","Hot","Mild"),
Humidity = c("High","High","High","High","Normal","Normal","Normal",
"High","Normal","Normal","Normal","High","Normal","High"),
Wind = c("Weak","Strong","Weak","Weak","Weak","Strong","Strong",
"Weak","Weak","Weak","Strong","Strong","Weak","Strong"),
PlayTennis = c("No","No","Yes","Yes","Yes","No","Yes",
"No","Yes","Yes","Yes","Yes","Yes","No")
)
# Build ID3 Decision Tree
model <- rpart(PlayTennis ~ Outlook + Temperature + Humidity + Wind,
data = data,
method = "class",
parms = list(split ="information")) #ID3 uses information gain
#Display model summary
print(model)

#plot decision tree
rpart.plot(model, type = 3, extra = 102, fallen.leaves = TRUE)


C4.5

Code:
#install and load required packages
install.packages("RWeka")

library(RWeka)

#create a sample dataset
data <- data.frame(
Outlook = c("Sunny","Sunny","Overcast","Rain","Rain","Rain","Overcast",
"Sunny","Sunny","Rain","Sunny","Overcast","Overcast","Rain"),
Temperature = c("Hot","Hot","Hot","Mild","Cool","Cool","Cool",
"Mild","Cool","Mild","Mild","Mild","Hot","Mild"),
Humidity = c("High","High","High","High","Normal","Normal","Normal",
"High","Normal","Normal","Normal","High","Normal","High"),
Wind = c("Weak","Strong","Weak","Weak","Weak","Strong","Strong",
"Weak","Weak","Weak","Strong","Strong","Weak","Strong"),
PlayTennis = c("No","No","Yes","Yes","Yes","No","Yes",
"No","Yes","Yes","Yes","Yes","Yes","No")
)
#step 2:- convert all string columns to factors
data[] <- lapply(data, as.factor)

#step 3:- Train c4.5 model (J48)
model <- J48(PlayTennis ~ Outlook + Temperature + Humidity + Wind, data = data)

#step 4:- View model summary
summary(model)
install.packages("partykit")
library(partykit)

plot(as.party(model))

----------------------------------------------------------

â— 13.1 Apriori Algorithm
â— 13.2 k- means Algorithm
â— 13.3 Agglomerative


13.1 Apriori Algorithm

1. Code:
install.packages("arules")
install.packages("arulesViz")

library(arules)
library(arulesViz)
data("Groceries")
inspect(head(Groceries,3))
View(Groceries)
rules<-apriori(Groceries,parameter =
list(support=0.01,confidence=0.09,maxlen=3,minlen=2))

rules

inspect(rules)

2. Code:
mba_data <- read.csv("data_apriori.csv",stringsAsFactors = FALSE)

#check the structure
str(mba_data)
View(mba_data)

#ensure correct column names (case-sensitive)
colnames(mba_data) <- c("Customer_id","Products")

#split 'Products' into individual items

trans_list <- strsplit(mba_data$Products, ",") #split by comma
trans_list <- lapply(trans_list, trimws) #remove leading/train

#Assign customer IDs as transaction names
names(trans_list) <- mba_data$Customer_id
# convert list to 'transactions' object
trans <- as(trans_list, "transactions")
#Inspect the transactions
inspect(head(trans, 5))
itemLabels(trans)
summary(trans)
#plot item frequencies

itemFrequencyPlot(trans, topN = 10, type = "absolute", main = "Top 10 most
Frequent items")
#generate apriori rules
rules <-apriori(
trans,
parameter = list(support = 0.05, confidence = 0.3 , minlen = 2, maxlen = 3)
)
#check rule summary
summary(rules)
#inspect top rules by lift
inspect(head(sort(rules,by = "lift"),10))
#visualize rules (interactive graph)
plot(rules,method = "graph", engine="htmlwidget")

#optional: Export rules to csv
rules_df <- as(rules, "data.frame")
write.csv(rules_df, "apriori_rules_output.csv", row.names= FALSE)

#print final confirmation
cat("Apriori analysis complete!Rules saved to =apriori_rules_output.csv'\n")


13.2 k-means Algorithm

Code:
#load necessary libararies
library(ggplot2)
library(dplyr)
#Select only numeric columns (1 to 4) from the iris dataset
mydata <- select(iris, c(1,2,3,4))
#apply k-means clustering with 3 clusters
model <- kmeans(mydata, 3)
model
#display number of items in each cluster
model$size
#compare actual species with cluster assignments
table(model$cluster, iris$Species)

#Convert cluster numbers to factor for plotting

iris$cluster <- as.factor(model$cluster)
#visualize clusters by Petal dimensions
ggplot(iris, aes(Petal.Length,Petal.Width, color=cluster)) +
geom_point(size = 3) +
labs(title = "K-Means clustering of Iris Dataset",
x = "Petal Length",
y = "Petal width")


13.3 Agglomerative

Code:
df <- USArrests
View(df)
df <- na.omit(df)
df
d <- scale(df)
head(d)
dist_matrix <- dist(d, method = "euclidean")
hc <- hclust(dist_matrix, method = "complete")
plot(hc,

main = "Hierarchical clustering - USArrests",
xlab = "",
sub = "")
plot(hc,
cex = 0.6, #reduce label size
hang = -1, #Align leaves at the same height
main = "Dendrogram with comapct labels")

hcd <- as.dendrogram(hc)
plot(hcd,
type = "triangle",
main = "triangular Dendrogram - USArrests")

groups <- cutree(hc, k = 4)
df$cluster <-groups
head(df)
plot(hc,cex = 0.6, hang = -1)
rect.hclust(hc,k=4, border = "red")
cut_tree <- cut(hcd, h = 75)
str(cut_tree)
plot(cut_tree$upper, main= "Upper dendrogram (Top Cluster sturture)")
plot(cut_tree$lower[[2]],main= " Detailed viewof cluster 2")


penta


File â†’ New â†’ Transformation â†’ Design
Drag Table Input â†’ Double Click â†’ New

Enter Database Connection Details:
Connection Name: conn
Host Name: localhost
Port: 1521
Database: ORCL
Username: system
Password: password
Connection Type: Oracle (Access Native JDBC)

If required â†’ Search & download ojdbc*.jar
Copy jar file â†’ Paste into:
Pentaho â†’ data-integration â†’ lib

Connection Successful â†’ OK â†’ OK
Get SQL Select Statement â†’ Select Table â†’ Preview â†’ OK
Right Click on Table Input â†’ Preview â†’ Quick Launch
In Design â†’ Output â†’ Table Output
Click on Table Input Output Connector â†’ Drag & Drop â†’ Table Output
Click on Table Output â†’
Set Target Table Name
Check Truncate Table if required
Click Database Fields â†’ Get Fields
SQL â†’ Execute (Query for output table gets auto generated)
Execute â†’ OK
Action â†’ Debug â†’ Quick Preview â†’ Yes
To check data is extracted â†’ Go to SQL:
Copy code

SELECT * FROM outputTable;

1.Calculator

create Input Table
Get fields

-> in design -> Transformers -> Calculator-> name: calculator->
field calculation field A  field B

Total A+B

-> ok -> create output table -> Action ->Debug-> calculator ->Quick launch and connect calculator with it -> right click ->
preview



2.Concatenate Table â€“ Steps 
Create Input Table
Design â†’ Transformer â†’ Concatenate Fields
Connect Input Table â†’ Click on Concatenate Field
Target Field Name: Join
Separator: , or - or | or anything you want
Get Fields
Remove fields that you do not want to concatenate
Keep only the fields you want to concatenate â†’ OK
Action â†’ Debug â†’ Connect to Output Table


3.Splitting Operation â€“ Steps 
Create New Table
Design â†’ Transformer â†’ Split Field
Connect Input Table â†’ Select the Field to Split
Give Fields Name (for split output fields)
Data Type: String
Length: e.g. 20
Create New Field Names for each split part
Action â†’ Debug â†’ Connect to Output Table


4) Number Range â€“ Steps 
Create Input Table
Design â†’ Transform â†’ Number Range
Double Click â†’ Select Input Field
Select Lower Bound & Upper Bound
OK
Connect to Output Table

5) String Operations â€“ Steps 
Select any Data Field
Trim Type â†’ Select Left
Padding â†’ Left
Pad Character â†’ * or @
Pad Length â†’ 10 or 20
Init Cap â†’ Y
OK


6) CSV Input â€“ Steps
Input â†’ CSV File Input
Double Click
Select CSV File
Get Fields â†’ OK
Preview â†’ OK
Close â†’ OK
Connect to Output Table

7) Merge â€“ Steps
Step 1
Input â†’ Select 2 Data Grids â†’ Drag & Drop
Double Click
Step Name: Employee
Step 2: Department
Meta: Enter Field Details
Data: Enter actual data â†’ OK

Step 2
Transform
Design â†’ Join â†’ Merge Join
Create Output Hop


SQL


1. Create table with range partition
CREATE TABLE sales(
  prod_id NUMBER(5),
  cust_id NUMBER(5),
  time_id DATE,
  channel_id CHAR(5),
  promo_id NUMBER(5),
  quantity_sold NUMBER(5),
  amount_sold NUMBER(10)
)
PARTITION BY RANGE(time_id)
(
  PARTITION sales_q1_2006 VALUES LESS THAN (TO_DATE('31-MAR-2006','DD-MON-YYYY')),
  PARTITION sales_q2_2006 VALUES LESS THAN (TO_DATE('31-MAY-2006','DD-MON-YYYY')),
  PARTITION sales_q3_2006 VALUES LESS THAN (TO_DATE('30-SEP-2006','DD-MON-YYYY')),
  PARTITION sales_q4_2006 VALUES LESS THAN (TO_DATE('31-DEC-2006','DD-MON-YYYY'))
);

2.2. Check partitions
SELECT table_name, partition_name, high_value, num_rows
FROM user_tab_partitions
WHERE table_name='SALESS';


3. Insert values
INSERT INTO table_name VALUES(data);

4. Fetch data from partition
SELECT * FROM table_name PARTITION(partition_name);

5. Add new partition
ALTER TABLE saless
ADD PARTITION sales_q1_2007
VALUES LESS THAN (TO_DATE('31-MAR-2007','DD-MON-YYYY'));

6. Truncate partition
ALTER TABLE table_name TRUNCATE PARTITION partition_name;

7. Drop partition

ALTER TABLE table_name DROP PARTITION partition_name;



1. Create table

CREATE TABLE Student(
  student_id NUMBER(5),
  student_name VARCHAR2(20),
  student_dob DATE
)
PARTITION BY LIST(student_name)
(
  PARTITION stu_divA VALUES('a','b','c','d','e','f','g','h','i','j','k'),
  PARTITION stu_divB VALUES('n','o','p','q','r','s','t','u','v','w','x','y','z')
);

insert values

INSERT INTO Student VALUES(0121,'c',TO_DATE('23-AUG-1963','DD-MON-YYYY'));
INSERT INTO Student VALUES(0122,'f',TO_DATE('11-AUG-1960','DD-MON-YYYY'));
INSERT INTO Student VALUES(0123,'i',TO_DATE('23-JUL-1978','DD-MON-YYYY'));
INSERT INTO Student VALUES(0124,'p',TO_DATE('03-AUG-1923','DD-MON-YYYY'));
INSERT INTO Student VALUES(0125,'s',TO_DATE('14-JAN-1963','DD-MON-YYYY'));
INSERT INTO Student VALUES(0126,'y',TO_DATE('09-FEB-1963','DD-MON-YYYY'));


3. Show partition data

SELECT * FROM Student1 PARTITION(stu_divA);
SELECT * FROM Student1 PARTITION(stu_divB);

4. View partitions

SELECT table_name, partition_name, high_value, num_rows
FROM user_tab_partitions
WHERE table_name='STUDENT1';


5. Add NULL partition

ALTER TABLE Student1 ADD PARTITION stu_null VALUES(NULL);


6. Insert NULL values

INSERT INTO Student1 VALUES(NULL,'p',TO_DATE('03-AUG-1923','DD-MON-YYYY'));
INSERT INTO Student1 VALUES(0124,'',TO_DATE('03-AUG-1923','DD-MON-YYYY'));


7. Show NULL partition

SELECT * FROM Student1 PARTITION(stu_null);


8. Modify partition

ALTER TABLE Student1 MODIFY PARTITION stu_divA ADD VALUES('m');

ðŸ”¹ Assignment 03 â€“ Analytical Queries

1. Create table

CREATE TABLE Employee1(
  EmpNo NUMBER(6),
  Name VARCHAR(10),
  Position VARCHAR(6),
  Manager NUMBER(6),
  JoinDate DATE,
  Salary NUMBER(7),
  DeptNo NUMBER(3)
);


2. Insert values

INSERT INTO Employee1 VALUES(1011,'Vansh','CEO',101103,TO_DATE('05-05-2025','DD-MM-YYYY'),100000,407);
INSERT INTO Employee1 VALUES(1032,'Bilal','CTO',104561,TO_DATE('04-07-2024','DD-MM-YYYY'),50000,458);
INSERT INTO Employee1 VALUES(1011,'Nandita','CFO',152358,TO_DATE('07-11-2022','DD-MM-YYYY'),80000,874);
INSERT INTO Employee1 VALUES(1021,'altamash','CA',152359,TO_DATE('07-10-2023','DD-MM-YYYY'),8000,875);
INSERT INTO Employee1 VALUES(1022,'tejas','CA',152360,TO_DATE('07-01-2023','DD-MM-YYYY'),7000,876);
INSERT INTO Employee1 VALUES(1024,'soham','CA',152361,TO_DATE('07-03-2023','DD-MM-YYYY'),70000,877);
INSERT INTO Employee1 VALUES(1026,'mohit','CS',152365,TO_DATE('07-03-2024','DD-MM-YYYY'),90000,878);


3. Rollup

SELECT DeptNo, SUM(Salary)
FROM Employee1
GROUP BY ROLLUP(DeptNo);


4. Cube

SELECT DeptNo, SUM(Salary)
FROM Employee1
GROUP BY CUBE(DeptNo);


5. Rank

SELECT Salary, RANK() OVER(ORDER BY Salary) FROM Employee1;


6. Dense Rank

SELECT Salary, DENSE_RANK() OVER(ORDER BY Salary) FROM Employee1;


7. Row Number

SELECT EmpNo, ROW_NUMBER() OVER(ORDER BY Salary) FROM Employee1;


8. Lead

SELECT DeptNo, EmpNo, Salary,
LEAD(Salary,1,0) OVER(PARTITION BY DeptNo ORDER BY Salary DESC)
FROM Employee1;


9. Lag

SELECT DeptNo, EmpNo, Salary,
LAG(Salary,1,0) OVER(PARTITION BY DeptNo ORDER BY Salary DESC)
FROM Employee1;

ðŸ”¹ Assignment 04 â€“ ORDBMS

Create Object

CREATE TYPE Name AS OBJECT(
  FName VARCHAR2(20),
  LName VARCHAR2(20)
);


Create Address Object

CREATE TYPE Address AS OBJECT(
  Street VARCHAR2(20),
  City VARCHAR2(20)
);


Function Object

CREATE TYPE Demo AS OBJECT(
  ID NUMBER,
  MEMBER FUNCTION get_square RETURN NUMBER
);

ðŸ”¹ Assignment 05 â€“ Window Functions

1. NVL

SELECT NVL(Salary,0) FROM Employee;


2. Preceding

SELECT SUM(Salary)
OVER(ORDER BY Salary ROWS 2 PRECEDING)
FROM Employee;


3. Following

SELECT SUM(Salary)
OVER(ORDER BY Salary ROWS BETWEEN 3 PRECEDING AND 1 FOLLOWING)
FROM Employee;

